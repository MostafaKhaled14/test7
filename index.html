<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="CSS/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/all.min.css">
    <link rel="stylesheet" href="CSS/style.css">
</head>

<body>

    <section class="mof-organizational-structure py-5">
      <div class="container position-relative">
        <div class="organizational-structure-image">
          <img src="./img/organizational-structure.jpg" alt="organizational-structure-image" />
        </div>

        <!-- أيقونة الفتح -->
        <div class="organizational-structure-icon d-md-non" id="organizational-structure-icon">
          <i class="NCGR-i-plus"></i>
        </div>

        <!-- البوب أب -->
        <div class="overlay" id="overlay">
          <div class="popup-content">
            <div class="close-btn">
              <i class="fa fa-link"></i>
            </div>
            <div class="zoom-container">
              <img class="zoomed-image" src="./img/organizational-structure.jpg" alt="zoomed-image" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <style>
        

        .calendar-image img {
  width: 100%;
  height: 100%;
  aspect-ratio: 2.5/4;
  object-fit: cover;
}

.organizational-structure-image img {
  width: 100%;
  height: 100%;
  aspect-ratio: 4/2.9;
  object-fit: cover;
}

.organizational-structure-icon {
  position: absolute;
  bottom: 12px;
  right: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 32px;
  height: 32px;
  border-radius: 100%;
  color: white;
  background-color: green;
  transition: 0.3s;
  z-index: 10;
}

.organizational-structure-icon:hover {
  color: green;
  background-color:white;
}

.organizational-structure-icon.active {
  color: green;
  background-color: white;
  box-shadow: 0 0 0 3px green;
}

.overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
}

.overlay.active {
  display: flex;
}

.popup-content {
  position: relative;
  width: 95%;
  height: 95%;
  border-radius: 8px;
  background-color: white;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.popup-content .close-btn {
  display: flex;
  justify-content: end;
  padding: 16px;
}

.zoom-container {
  flex: 1;
  overflow: hidden;
  touch-action: pinch-zoom;
}

.zoomed-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  transform-origin: center center;
  transition: transform 0.2s ease;
}

    </style>

    <script>
        const organizationalStructureIcon = document.getElementById("organizational-structure-icon");
const popup = document.getElementById("overlay");
const zoomedImg = popup.querySelector(".zoomed-image");
const closeBtn = popup.querySelector(".close-btn");

let zoomLevel = 1;

// فتح البوب أب
organizationalStructureIcon.addEventListener("click", () => {
  popup.classList.add("active");
  organizationalStructureIcon.classList.add("active");
    document.body.style.overflow = "hidden"; 

});

// قفل البوب أب لما يدوس على الخلفية أو زر الإغلاق
popup.addEventListener("click", (e) => {
  if (e.target === popup || e.target.closest(".close-btn")) {
    popup.classList.remove("active");
    organizationalStructureIcon.classList.remove("active");
    zoomLevel = 1;
    zoomedImg.style.transform = `scale(${zoomLevel})`;
        document.body.style.overflow = ""; 

  }
});

// دعم الزوم بصباعين (Pinch to Zoom)
let initialDistance = 0;
popup.addEventListener("touchmove", (e) => {
  if (e.touches.length === 2) {
    const dist = Math.hypot(
      e.touches[0].clientX - e.touches[1].clientX,
      e.touches[0].clientY - e.touches[1].clientY
    );
    if (initialDistance === 0) initialDistance = dist;

    const scale = dist / initialDistance;
    zoomLevel = Math.min(Math.max(1, scale), 3); // بين 1x و 3x
    zoomedImg.style.transform = `scale(${zoomLevel})`;
  }
});

popup.addEventListener("touchend", () => {
  initialDistance = 0;
});


// zoomedImg.addEventListener("wheel", (e) => {
//   e.preventDefault();
//   zoomLevel += e.deltaY * -0.04;
//   zoomLevel = Math.min(Math.max(1, zoomLevel), 3);
//   zoomedImg.style.transform = `scale(${zoomLevel})`;
// });


    </script>

    <!-- <script src="js/script.js"></script> -->
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/min.js"></script>
</body>

</html>