<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="CSS/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/all.min.css">
    <link rel="stylesheet" href="CSS/style.css">
</head>

<body>

    <section class="mof-organizational-structure py-5">
      <div class="container position-relative">
        <div class="organizational-structure-image">
          <img src="./img/organizational-structure.jpg" alt="organizational-structure-image" />
        </div>

        <!-- أيقونة الفتح -->
        <div class="organizational-structure-icon d-md-non" id="organizational-structure-icon">
          <i class="fa fa-link p-4"></i>
        </div>

        <!-- البوب أب -->
        <div class="overlay" id="overlay">
          <div class="popup-content">
            <div class="close-btn">
              <i class="fa fa-close"></i>
            </div>
            <div class="zoom-container">
              <img class="zoomed-image" src="./img/organizational-structure.jpg" alt="zoomed-image" />
            </div>
          </div>
        </div>
      </div>
    </section>

    <style>
        

        .calendar-image img {
  width: 100%;
  height: 100%;
  aspect-ratio: 2.5/4;
  object-fit: cover;
}

.organizational-structure-image img {
  width: 100%;
  height: 100%;
  aspect-ratio: 4/2.9;
  object-fit: cover;
}

.organizational-structure-icon {
  position: absolute;
  bottom: 12px;
  right: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 32px;
  height: 32px;
  border-radius: 100%;
  color: white;
  background-color: green;
  transition: 0.3s;
  z-index: 10;
  /* padding: 10px; */
}

.organizational-structure-icon:hover {
  color: green;
  background-color:white;
}

.organizational-structure-icon.active {
  color: green;
  background-color: white;
  box-shadow: 0 0 0 3px green;
}

.overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
}

.overlay.active {
  display: flex;
}

.popup-content {
  position: relative;
  width: 95%;
  height: 95%;
  border-radius: 8px;
  background-color: white;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.popup-content .close-btn {
  display: flex;
  justify-content: end;
  padding: 16px;
}

.zoom-container {
  flex: 1;
  overflow: hidden;
  touch-action: none; /* مهم جدًا علشان التتش يتحكم بحرية */
}

.zoomed-image {
  width: 100%;
  height: 100%;
  object-fit: contain;
  transform-origin: center center;
  transition: transform 0.05s linear; /* حركة ناعمة جدًا */
  cursor: grab;
}


    </style>

    <!-- <script>
      const organizationalStructureIcon = document.getElementById("organizational-structure-icon");
const popup = document.getElementById("overlay");
const zoomedImg = popup.querySelector(".zoomed-image");
const closeBtn = popup.querySelector(".close-btn");

let zoomLevel = 1;
let posX = 0, posY = 0;
let startX = 0, startY = 0;
let isDragging = false;
let initialDistance = 0;
let initialScale = 1;

// فتح البوب أب
organizationalStructureIcon.addEventListener("click", () => {
  popup.classList.add("active");
  organizationalStructureIcon.classList.add("active");
  document.body.style.overflow = "hidden";
});

// قفل البوب أب
popup.addEventListener("click", (e) => {
  if (e.target === popup || e.target.closest(".close-btn")) {
    popup.classList.remove("active");
    organizationalStructureIcon.classList.remove("active");
    zoomLevel = 1;
    posX = 0;
    posY = 0;
    zoomedImg.style.transform = `scale(1) translate(0px, 0px)`;
    document.body.style.overflow = "";
  }
});

// دعم الزوم بالماوس (للكمبيوتر)
zoomedImg.addEventListener("wheel", (e) => {
  e.preventDefault();
  const delta = e.deltaY > 0 ? -0.1 : 0.1;
  zoomLevel = Math.min(Math.max(1, zoomLevel + delta), 4);
  zoomedImg.style.transform = `scale(${zoomLevel}) translate(${posX}px, ${posY}px)`;
});

// دعم السحب (pan) بالماوس
zoomedImg.addEventListener("mousedown", (e) => {
  if (zoomLevel === 1) return;
  isDragging = true;
  startX = e.clientX - posX;
  startY = e.clientY - posY;
  zoomedImg.style.cursor = "grabbing";
});

window.addEventListener("mouseup", () => {
  isDragging = false;
  zoomedImg.style.cursor = "grab";
});

window.addEventListener("mousemove", (e) => {
  if (!isDragging) return;
  posX = e.clientX - startX;
  posY = e.clientY - startY;
  zoomedImg.style.transform = `scale(${zoomLevel}) translate(${posX}px, ${posY}px)`;
});

// دعم الزوم والسحب على الموبايل
zoomedImg.addEventListener("touchstart", (e) => {
  if (e.touches.length === 1) {
    isDragging = true;
    startX = e.touches[0].clientX - posX;
    startY = e.touches[0].clientY - posY;
  } else if (e.touches.length === 2) {
    isDragging = false;
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    initialDistance = Math.sqrt(dx * dx + dy * dy);
    initialScale = zoomLevel;
  }
});

zoomedImg.addEventListener("touchmove", (e) => {
  e.preventDefault();
  if (isDragging && e.touches.length === 1 && zoomLevel > 1) {
    posX = e.touches[0].clientX - startX;
    posY = e.touches[0].clientY - startY;
    zoomedImg.style.transform = `scale(${zoomLevel}) translate(${posX}px, ${posY}px)`;
  } else if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    const distance = Math.sqrt(dx * dx + dy * dy);
    const scaleChange = distance / initialDistance;
    zoomLevel = Math.min(Math.max(1, initialScale * scaleChange), 4);
    zoomedImg.style.transform = `scale(${zoomLevel}) translate(${posX}px, ${posY}px)`;
  }
});

zoomedImg.addEventListener("touchend", (e) => {
  if (e.touches.length === 0) isDragging = false;
});

    </script> -->

  <script>
    const organizationalStructureIcon = document.getElementById("organizational-structure-icon");
const popup = document.getElementById("overlay");
const zoomedImg = popup.querySelector(".zoomed-image");
const closeBtn = popup.querySelector(".close-btn");

let zoomLevel = 1;
let posX = 0, posY = 0;
let startX = 0, startY = 0;
let isDragging = false;
let initialDistance = 0;
let initialScale = 1;

// فتح البوب أب
organizationalStructureIcon.addEventListener("click", () => {
  popup.classList.add("active");
  organizationalStructureIcon.classList.add("active");
  document.body.style.overflow = "hidden";
});

// قفل البوب أب
popup.addEventListener("click", (e) => {
  if (e.target === popup || e.target.closest(".close-btn")) {
    popup.classList.remove("active");
    organizationalStructureIcon.classList.remove("active");
    zoomLevel = 1;
    posX = 0;
    posY = 0;
    zoomedImg.style.transform = `translate(0px, 0px) scale(1)`;
    document.body.style.overflow = "";
  }
});

// =============== دعم السحب بالماوس ===============
zoomedImg.addEventListener("mousedown", (e) => {
  if (zoomLevel === 1) return;
  isDragging = true;
  startX = e.clientX - posX;
  startY = e.clientY - posY;
  zoomedImg.style.cursor = "grabbing";
});

window.addEventListener("mouseup", () => {
  isDragging = false;
  zoomedImg.style.cursor = "grab";
});

window.addEventListener("mousemove", (e) => {
  if (!isDragging) return;
  posX = e.clientX - startX;
  posY = e.clientY - startY;
  requestAnimationFrame(() => {
    zoomedImg.style.transform = `translate(${posX}px, ${posY}px) scale(${zoomLevel})`;
  });
});

// =============== دعم الزوم بالماوس ===============
zoomedImg.addEventListener("wheel", (e) => {
  e.preventDefault();
  const delta = e.deltaY > 0 ? -0.1 : 0.1;
  zoomLevel = Math.min(Math.max(1, zoomLevel + delta), 4);
  requestAnimationFrame(() => {
    zoomedImg.style.transform = `translate(${posX}px, ${posY}px) scale(${zoomLevel})`;
  });
});

// =============== دعم اللمس على الموبايل ===============
let lastTouchX = 0;
let lastTouchY = 0;

zoomedImg.addEventListener("touchstart", (e) => {
  if (e.touches.length === 1) {
    isDragging = true;
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;
  } else if (e.touches.length === 2) {
    isDragging = false;
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    initialDistance = Math.sqrt(dx * dx + dy * dy);
    initialScale = zoomLevel;
  }
});

zoomedImg.addEventListener("touchmove", (e) => {
  e.preventDefault();
  if (isDragging && e.touches.length === 1 && zoomLevel > 1) {
    const deltaX = e.touches[0].clientX - lastTouchX;
    const deltaY = e.touches[0].clientY - lastTouchY;
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;

    posX += deltaX;
    posY += deltaY;
    requestAnimationFrame(() => {
      zoomedImg.style.transform = `translate(${posX}px, ${posY}px) scale(${zoomLevel})`;
    });
  } else if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    const distance = Math.sqrt(dx * dx + dy * dy);
    const scaleChange = distance / initialDistance;
    zoomLevel = Math.min(Math.max(1, initialScale * scaleChange), 4);
    requestAnimationFrame(() => {
      zoomedImg.style.transform = `translate(${posX}px, ${posY}px) scale(${zoomLevel})`;
    });
  }
});

zoomedImg.addEventListener("touchend", (e) => {
  if (e.touches.length === 0) isDragging = false;
});

  </script>

    <!-- <script src="js/script.js"></script> -->
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/min.js"></script>
</body>

</html>